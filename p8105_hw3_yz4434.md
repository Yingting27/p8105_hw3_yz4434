Homework 3
================
Yingting Zhang
2023-10-11

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(ggridges)
```

# Question 2

``` r
library(p8105.datasets)
data("brfss_smart2010")
```

## Data cleaning

``` r
brfss = brfss_smart2010 |> 
  janitor::clean_names() |> 
  filter(topic == "Overall Health") |> 
  filter(response %in% c("Excellent", "Very good", "Good", "Fair", "Poor")) |>
  mutate(
    response = forcats::fct_relevel(response, c("Poor","Fair","Good","Very good","Excellent"))
  ) |> rename(state = locationabbr) |> rename(county = locationdesc)
```

# In 2002, which states were observed at 7 or more locations? What about in 2010?

``` r
brfss_2002 = brfss |> 
  filter(year =="2002") |> 
  group_by(state) |> 
  summarise(n_obs = n_distinct(county)) |> 
  filter(n_obs >= 7)

brfss_2010 = brfss |> 
  filter(year =="2010") |> 
  group_by(state) |> 
  summarise(n_obs = n_distinct(county)) |> 
  filter(n_obs >= 7)
```

In 2002, \*\*\*\* were observed at 7 or more locations. In 2010,
\*\*\*\* were observed at 7 or more locations.

# Construct a dataset

``` r
brfss_conduct = brfss |> 
  filter(response =="Excellent") |> 
  group_by(year,state) |> 
  summarise(
    mean_value = mean(data_value,na.rm = TRUE),.groups = "drop") |> 
  ggplot(aes(x = year, y = mean_value, color = state))+ geom_line()
```

# Make a two-panel plot showing

``` r
brfss_panel= brfss |> 
  filter(year %in% c("2006", "2010")) |> 
  filter(state == "NY") |> 
  ggplot(aes(x = response, y = data_value)) + geom_boxplot()+
  facet_grid(.~ year)
```

## Question 3

# Load, tidy, merge, and otherwise organize the data sets

- accel data sets

``` r
nhanes_accel = 
  read_csv("data/nhanes_accel.csv", col_types = 
      cols(
        `SEQN` = col_character() 
)) |> 
  janitor::clean_names()
```

- covar data sets

``` r
nhanes_covar = 
  read_csv("data/nhanes_covar.csv", skip = 4, col_types = 
      cols(
        `SEQN` = col_character()
      )) |>
  janitor::clean_names() |> 
  filter(age >= 21) |> 
  drop_na(bmi) |>
  drop_na(education) |> 
      mutate(
    sex = case_match(
      sex,
      1 ~ "male",
      2 ~ "female")
    )|> 
      mutate(
    education = case_match(
      education,
      1 ~ "Less than high school",
      2 ~ "High school equivalent",
      3 ~ "More than high school"))
```

- merge datasets

``` r
merge_data = left_join(nhanes_covar,nhanes_accel,by = "seqn")
```
